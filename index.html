<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#ff6a00" />

  <link rel="canonical" href="https://prayerandfire.org/" />
  <title>Prayer & Fire – Global Movement</title>

  <meta name="description" content="Prayer & Fire is a global Christian movement where believers unite in prayer and faith-centered resources with a global vision." />
  <meta name="keywords" content="Prayer and Fire, global movement, prayer, christian movement, faith-based resources, donations" />
  <meta name="robots" content="index,follow" />

  <!-- Open Graph -->
  <meta property="og:title" content="Prayer & Fire – Global Movement" />
  <meta property="og:description" content="A global Christian movement where believers unite in prayer and faith-centered resources with a global vision." />
  <meta property="og:url" content="https://prayerandfire.org/" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://prayerandfire.org/logo.jpg" />
  <meta property="og:image:secure_url" content="https://prayerandfire.org/logo.jpg" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Prayer & Fire – Global Movement" />
  <meta name="twitter:description" content="A global Christian movement where believers unite in prayer and faith-centered resources with a global vision." />
  <meta name="twitter:image" content="https://prayerandfire.org/logo.jpg" />

  <!-- Favicon -->
  <link rel="icon" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">

  <!-- GitHub Pages preview compatibility -->
  <link id="pfFavicon32" rel="icon" type="image/png" sizes="32x32" href="./favicon-32x32.png">
  <link id="pfFavicon16" rel="icon" type="image/png" sizes="16x16" href="./favicon-16x16.png">
  <link id="pfAppleIcon" rel="apple-touch-icon" href="./apple-touch-icon.png">
  <link id="pfManifest" rel="manifest" href="./site.webmanifest">

  <!-- Google tag (gtag.js) - SPA SAFE -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-GVR33MJKHC"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-GVR33MJKHC', { send_page_view: false });
  </script>

  <!-- Supabase JS -->
  <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    :root{
      --bg:#0b0b0f;
      --panel:#101018;
      --card:#141422;
      --border:#25253a;
      --text:#f4f4fb;
      --muted:#b8b8cc;
      --accent:#ff6a00;
      --accentSoft:rgba(255,106,0,.14);
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
      --radius2: 24px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      background: radial-gradient(1200px 800px at 20% -10%, rgba(255,106,0,.10), transparent 60%),
                  radial-gradient(1000px 700px at 90% 10%, rgba(120,80,255,.08), transparent 55%),
                  var(--bg);
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      line-height:1.55;
    }
    a{color:var(--accent); text-decoration:none}
    a:hover{text-decoration:underline}
    .app{ min-height:100%; display:flex; flex-direction:column; }

    .topbar{
      position:sticky;
      top:0;
      z-index:50;
      backdrop-filter: blur(14px);
      background: rgba(11,11,15,.65);
      border-bottom:1px solid rgba(37,37,58,.65);
    }
    .topbarInner{
      max-width:1200px;
      margin:0 auto;
      padding:14px 16px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
    }

    .brandLink{
      display:flex;
      align-items:center;
      gap:10px;
      min-width: 220px;
      padding:6px 8px;
      border-radius: 14px;
      border:1px solid rgba(255,255,255,.06);
      background: rgba(16,16,24,.35);
      cursor:pointer;
      transition: transform .10s ease, border-color .18s ease, background .18s ease, box-shadow .18s ease;
      color: inherit;
    }
    .brandLink:hover{
      border-color: rgba(255,106,0,.35);
      background: rgba(16,16,24,.55);
      box-shadow: 0 10px 28px rgba(0,0,0,.28), 0 0 0 3px rgba(255,106,0,.08);
      transform: translateY(-1px);
      text-decoration:none;
    }
    .brandLink:active{ transform: translateY(0px) scale(.99); }
    .brandLink:focus{
      outline:none;
      box-shadow: 0 0 0 3px rgba(255,106,0,.18), 0 10px 28px rgba(0,0,0,.28);
    }

    .brandLogo{
      width:46px;height:46px;border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      display:flex;align-items:center;justify-content:center;
      overflow:hidden;
      flex-shrink:0;
    }
    .brandLogo img{width:100%;height:100%;object-fit:cover}
    .logoFallback{
      width:100%;height:100%;
      display:none;
      align-items:center;justify-content:center;
      font-weight:800;
      letter-spacing:.5px;
      color: rgba(255,106,0,.95);
      background: rgba(255,106,0,.10);
    }

    .brandTitle{display:flex; flex-direction:column; line-height:1.1;}
    .brandTitle strong{font-size:14px; letter-spacing:.2px}
    .brandTitle span{font-size:12px;color:var(--muted)}

    .langWrap{
      display:flex;
      align-items:center;
      gap:8px;
      padding:8px 10px;
      border-radius: 999px;
      border:1px solid rgba(37,37,58,.9);
      background: rgba(16,16,24,.65);
      flex-shrink:0;
    }
    .langWrap span{font-size:12px;color:var(--muted);white-space:nowrap;}
    .langWrap select{
      width:auto;
      padding:8px 10px;
      border-radius: 999px;
      border:1px solid rgba(37,37,58,.9);
      background: rgba(11,11,16,.7);
      color:var(--text);
      outline:none;
      font-size:13px;
      cursor:pointer;
    }

    .nav{
      max-width:1200px;
      margin:0 auto;
      padding:10px 16px 14px;
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      justify-content:flex-start;
    }
    .nav button{
      appearance:none;
      border:1px solid rgba(37,37,58,.9);
      background: rgba(16,16,24,.65);
      color:var(--text);
      padding:10px 12px;
      border-radius:999px;
      font-size:13px;
      cursor:pointer;
      transition: transform .08s ease, border-color .15s ease, background .15s ease;
    }
    .nav button:hover{
      border-color: rgba(255,255,255,.18);
      background: rgba(20,20,34,.7);
      transform: translateY(-1px);
      text-decoration:none;
    }
    .nav button.active{
      border-color: rgba(255,106,0,.6);
      background: rgba(255,106,0,.12);
    }

    .main{
      max-width:1200px;
      width:100%;
      margin:0 auto;
      padding:18px 16px 70px;
      display:flex;
      gap:16px;
    }
    .pages{flex:1; min-width:0;}
    .page{
      display:none;
      background: rgba(16,16,24,.75);
      border:1px solid rgba(37,37,58,.9);
      border-radius: var(--radius2);
      box-shadow: var(--shadow);
      overflow:hidden;
      animation: fadeIn .18s ease;
    }
    .page.active{display:block}
    @keyframes fadeIn{
      from{opacity:.65; transform: translateY(6px)}
      to{opacity:1; transform: translateY(0)}
    }

    .pageHeader{
      padding:22px 22px 16px;
      border-bottom: 1px solid rgba(37,37,58,.75);
      background: linear-gradient(180deg, rgba(255,106,0,.10), transparent 55%);
    }
    .pageHeader h1{margin:0; font-size:22px; letter-spacing:.2px;}
    .pageHeader p{margin:8px 0 0; color:var(--muted); font-size:14px; max-width: 78ch;}

    .content{padding:18px 22px 24px;}
    .grid{display:grid; gap:14px; grid-template-columns: 1fr;}
    @media(min-width: 920px){ .grid{grid-template-columns: 1fr 1fr} }
    .card{
      background: rgba(20,20,34,.65);
      border:1px solid rgba(37,37,58,.85);
      border-radius: var(--radius);
      padding:16px;
    }
    .card h3{margin:0 0 8px; font-size:15px; letter-spacing:.2px;}
    .card p{margin:0;color:var(--muted);font-size:14px}
    .list{margin:10px 0 0 18px; color:var(--muted); font-size:14px;}
    .list li{margin:7px 0}
    .note{margin-top:10px; color:var(--muted); font-size:13px;}

    .homeStat{
      margin-top:10px;
      padding:10px 12px;
      border-radius: 14px;
      display:inline-flex;
      align-items:center;
      gap:8px;
      border:1px solid rgba(255,106,0,.35);
      background: rgba(255,106,0,.10);
      color: var(--text);
      font-size:13px;
      font-weight:600;
    }

    .btnRow{display:flex; flex-wrap:wrap; gap:10px; margin-top:14px;}
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding:11px 14px;
      border-radius: 14px;
      border:1px solid rgba(37,37,58,.9);
      background: rgba(20,20,34,.65);
      color:var(--text);
      font-weight:650;
      font-size:14px;
      cursor:pointer;
      transition: transform .08s ease, border-color .15s ease, background .15s ease;
    }
    .btn:hover{
      border-color: rgba(255,255,255,.18);
      background: rgba(26,26,44,.70);
      transform: translateY(-1px);
      text-decoration:none;
    }
    .btnPrimary{
      border-color: rgba(255,106,0,.55);
      background: rgba(255,106,0,.14);
    }
    .btnDisabled{
      opacity:.55;
      cursor:not-allowed;
      pointer-events:none;
      border-color: rgba(37,37,58,.9);
      background: rgba(20,20,34,.45);
    }

    .managePanel{
      border:1px solid rgba(255,106,0,.35);
      background: rgba(255,106,0,.08);
    }
    .managePanel p{ color: var(--muted); }

    footer{
      max-width:1200px;
      margin:0 auto;
      padding:0 16px 30px;
      color:var(--muted);
      font-size:13px;
      text-align:center;
    }
    .footerLinks{
      margin-top:10px;
      display:flex;
      gap:14px;
      justify-content:center;
      flex-wrap:wrap;
    }

    .formGrid{display:grid; gap:12px; margin-top:12px;}
    .field label{display:block; font-size:13px; color:var(--muted); margin-bottom:6px;}
    .field input, .field textarea{
      width:100%;
      padding:12px 12px;
      border-radius: 14px;
      border:1px solid rgba(37,37,58,.9);
      background: rgba(11,11,16,.55);
      color:var(--text);
      outline:none;
      font-size:14px;
    }
    .field textarea{min-height:120px; resize:vertical;}
    .status{margin-top:12px; font-size:13px; color:var(--muted);}
    .status.ok{color:#9fe6b8;}
    .status.bad{color:#ffb4b4;}

    /* LEADERS */
    .leadersWrap{
      margin-top: 6px;
      display:flex;
      flex-wrap:wrap;
      gap:22px;
      justify-content:center;
    }
    .leader{
      width: 260px;
      text-align:center;
      padding: 14px 12px;
      border-radius: var(--radius);
      border:1px solid rgba(37,37,58,.85);
      background: rgba(11,11,16,.35);
    }
    .leaderAvatar{
      width: 150px;
      height: 150px;
      margin: 4px auto 10px;
      border-radius: 999px;
      overflow:hidden;
      border:2px solid rgba(255,106,0,.55);
      box-shadow: 0 10px 26px rgba(0,0,0,.35);
      background: rgba(0,0,0,.18);
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .leaderAvatar img{
      width:100%;
      height:100%;
      object-fit: contain;
      object-position:center;
      display:block;
      background: rgba(0,0,0,.22);
    }
    .leaderRole{
      margin-top: 8px;
      font-weight: 800;
      letter-spacing:.2px;
      color: var(--accent);
      font-size: 13px;
    }
    .leaderName{
      margin-top: 4px;
      font-weight: 750;
      font-size: 14px;
    }
    .leaderNote{
      margin-top: 6px;
      color: var(--muted);
      font-size: 12px;
    }

    /* BOOKS */
    .booksGrid{
      display:grid;
      gap:14px;
      grid-template-columns: 1fr;
    }
    @media(min-width: 720px){ .booksGrid{ grid-template-columns: 1fr 1fr; } }
    @media(min-width: 1100px){ .booksGrid{ grid-template-columns: 1fr 1fr 1fr; } }

    .bookCard{
      background: rgba(20,20,34,.65);
      border:1px solid rgba(37,37,58,.85);
      border-radius: var(--radius);
      overflow:hidden;
      display:flex;
      flex-direction:column;
      min-height: 100%;
    }
    .bookCover{
      width:100%;
      aspect-ratio: 3 / 4;
      background: rgba(0,0,0,.18);
      border-bottom:1px solid rgba(37,37,58,.75);
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }
    .bookCover img{
      width:100%;
      height:100%;
      object-fit: cover;
      display:block;
    }
    .bookBody{ padding:14px; display:flex; flex-direction:column; gap:10px; }
    .bookTitle{
      font-weight:800;
      letter-spacing:.2px;
      font-size:14px;
      margin:0;
      color: var(--text);
      line-height:1.25;
    }
    .bookMeta{
      margin:0;
      color: var(--muted);
      font-size:13px;
    }
    .bookActions{ margin-top:auto; display:flex; gap:10px; flex-wrap:wrap; }

    .adminWrap{
      margin-top:14px;
      border:1px solid rgba(255,106,0,.35);
      background: rgba(255,106,0,.08);
      border-radius: var(--radius);
      padding:14px;
      display:none;
    }
    .adminWrap.active{ display:block; }
    .adminGrid{
      display:grid;
      gap:12px;
      grid-template-columns: 1fr;
    }
    @media(min-width: 920px){ .adminGrid{ grid-template-columns: 1fr 1fr; } }
    .adminRow{ display:flex; gap:10px; flex-wrap:wrap; margin-top:10px; }
    .tinyNote{ color: var(--muted); font-size: 12px; margin-top: 8px; }

    /* Books status box */
    .booksStatusBox{
      margin: 0 0 12px;
      padding: 12px 12px;
      border-radius: 14px;
      border: 1px solid rgba(37,37,58,.85);
      background: rgba(11,11,16,.35);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
    }
    .booksStatusText{
      color: var(--muted);
      font-size: 13px;
      margin:0;
    }

    @media(max-width: 720px){
      .brandLink{min-width:auto}
      .langWrap span{display:none;}
      .topbarInner{justify-content:space-between;}
      .nav{justify-content:center;}
      .main{padding-top:14px}
      .brandLogo{width:44px;height:44px;border-radius:14px;}
      .leader{width: 100%;}
      .leaderAvatar{width: 165px; height: 165px;}
    }
  </style>
</head>

<body>
<div class="app">

  <div class="topbar">
    <div class="topbarInner">
      <button class="brandLink navBtn" data-go="home" type="button" aria-label="Home">
        <div class="brandLogo" aria-hidden="true">
          <img id="pfLogo" src="./logo.jpg" alt="Prayer & Fire logo">
          <div id="logoFallback" class="logoFallback">P&amp;F</div>
        </div>
        <div class="brandTitle">
          <strong data-i18n="brand_title">Prayer & Fire</strong>
          <span data-i18n="brand_subtitle">Global Movement</span>
        </div>
      </button>

      <div class="langWrap" title="Language">
        <span data-i18n="lang_label">Language</span>
        <select id="langSelect" aria-label="Language">
          <option value="en" selected>EN</option>
          <option value="es">ES</option>
          <option value="pt">PT</option>
        </select>
      </div>
    </div>

    <div class="nav" role="navigation" aria-label="Primary">
      <button class="navBtn active" data-go="home" data-i18n="nav_home" type="button">Home</button>
      <button class="navBtn" data-go="about" data-i18n="nav_about" type="button">Who we are</button>
      <button class="navBtn" data-go="beliefs" data-i18n="nav_beliefs" type="button">Beliefs & Values</button>
      <button class="navBtn" data-go="app" data-i18n="nav_app" type="button">Download App</button>
      <button class="navBtn" data-go="store" data-i18n="nav_store" type="button">P&F Store</button>
      <button class="navBtn" data-go="social" data-i18n="nav_social" type="button">Social Media</button>
      <button class="navBtn" data-go="volunteers" data-i18n="nav_volunteers" type="button">Volunteers</button>
      <button class="navBtn" data-go="salvation" data-i18n="nav_salvation" type="button">Salvation</button>
      <button class="navBtn" data-go="support" data-i18n="nav_support" type="button">Support</button>
      <button class="navBtn" data-go="contact" data-i18n="nav_contact" type="button">Contact</button>
    </div>
  </div>

  <div class="main">
    <div class="pages" id="pages">

      <!-- HOME -->
      <section class="page active" data-page="home">
        <div class="pageHeader">
          <h1 data-i18n="home_title">Prayer & Fire – Global Movement</h1>
          <p data-i18n="home_subtitle">
            A global Christian movement where believers unite in prayer and faith-centered resources with a global vision.
          </p>
          <div class="homeStat" data-i18n="home_stat">
            40+ countries represented, praying 24/7 in different languages.
          </div>
        </div>
        <div class="content">
          <div class="grid">
            <div class="card">
              <h3 data-i18n="home_mission_title">Mission</h3>
              <p data-i18n="home_mission_text">
                Prayer & Fire exists to strengthen believers through prayer and faith-centered resources with a global vision.
              </p>
              <div class="btnRow">
                <button class="btn btnPrimary navBtn" data-go="about" type="button">
                  <span data-i18n="home_learn_more">Learn more</span>
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ABOUT -->
      <section class="page" data-page="about">
        <div class="pageHeader">
          <h1 data-i18n="about_title">Who we are</h1>
          <p data-i18n="about_subtitle">
            Prayer & Fire was founded on September 13, 2024 — a word directed by the Lord to raise a global movement of prayer and faith.
          </p>
        </div>
        <div class="content">
          <div class="grid">
            <div class="card">
              <h3 data-i18n="about_what_title">What we are</h3>
              <p data-i18n="about_what_text">
                A global Christian movement focused on prayer, spiritual growth, and resources that strengthen believers worldwide.
              </p>
            </div>
            <div class="card">
              <h3 data-i18n="about_do_title">What we do</h3>
              <ul class="list">
                <li data-i18n="about_do_1">Prayer gatherings and intercession</li>
                <li data-i18n="about_do_2">Community building and support</li>
                <li data-i18n="about_do_3">Faith-based resources and outreach</li>
              </ul>
            </div>
          </div>

          <div class="card" style="margin-top:14px;">
            <h3 data-i18n="leaders_title" style="text-align:center;">Founders</h3>

            <div class="leadersWrap">
              <div class="leader">
                <div class="leaderAvatar">
                  <img id="pfAline" src="./aline.png" alt="Aline Ramiro">
                </div>
                <div class="leaderRole" data-i18n="leaders_founder">Founder</div>
                <div class="leaderName">Aline Ramiro</div>
              </div>

              <div class="leader">
                <div class="leaderAvatar">
                  <img id="pfFrancisco" src="./francisco.png" alt="Francisco Rivera">
                </div>
                <div class="leaderRole" data-i18n="leaders_president">President</div>
                <div class="leaderName">Francisco Rivera</div>
              </div>
            </div>

            <div class="leaderNote" data-i18n="leaders_note" style="text-align:center;margin-top:12px;">
              Prayer & Fire leadership is committed to serving the global body of Christ through prayer and faith.
            </div>
          </div>
        </div>
      </section>

      <!-- BELIEFS -->
      <section class="page" data-page="beliefs">
        <div class="pageHeader">
          <h1 data-i18n="beliefs_title">Beliefs & Values</h1>
          <p data-i18n="beliefs_subtitle">Our foundation is Jesus Christ and the Word of God.</p>
        </div>
        <div class="content">
          <div class="grid">
            <div class="card">
              <h3 data-i18n="beliefs_beliefs_title">Beliefs</h3>
              <ul class="list">
                <li data-i18n="beliefs_b1">Jesus Christ is Lord and Savior.</li>
                <li data-i18n="beliefs_b2">The Bible is the Word of God.</li>
                <li data-i18n="beliefs_b3">Salvation is by grace through faith in Christ.</li>
                <li data-i18n="beliefs_b4">Prayer transforms lives and aligns us with God’s will.</li>
              </ul>
            </div>
            <div class="card">
              <h3 data-i18n="beliefs_values_title">Values</h3>
              <ul class="list">
                <li data-i18n="beliefs_v1">Faith and obedience</li>
                <li data-i18n="beliefs_v2">Integrity and humility</li>
                <li data-i18n="beliefs_v3">Love, compassion, unity</li>
                <li data-i18n="beliefs_v4">Excellence in service</li>
                <li data-i18n="beliefs_v5">Global vision</li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <!-- APP -->
      <section class="page" data-page="app">
        <div class="pageHeader">
          <h1 data-i18n="app_title">Download the App</h1>
          <p data-i18n="app_subtitle">Prayer & Fire Mobile is coming soon.</p>
        </div>
        <div class="content">
          <div class="card">
            <h3 data-i18n="app_card_title">Prayer & Fire Mobile</h3>
            <div class="btnRow">
              <span class="btn btnPrimary btnDisabled" data-i18n="app_btn_disabled">Coming soon</span>
            </div>
          </div>
          <div class="note" data-i18n="app_android">Android version coming soon.</div>
        </div>
      </section>

      <!-- STORE -->
      <section class="page" data-page="store">
        <div class="pageHeader">
          <h1 data-i18n="store_title">P&F Store</h1>
          <p data-i18n="store_subtitle">
            Apparel & products are available worldwide via Etsy. The book is available on Amazon.
          </p>
        </div>

        <div class="content">
          <div class="grid">
            <div class="card">
              <h3 data-i18n="store_etsy_title">Apparel & Products (Etsy)</h3>
              <p data-i18n="store_etsy_text">Shop our official Prayer & Fire store.</p>
              <div class="btnRow">
                <a class="btn btnPrimary" href="https://prayerandfire.etsy.com" target="_blank" rel="noopener">
                  <span data-i18n="store_etsy_btn">Open Etsy Store</span>
                </a>
              </div>
              <div class="note" data-i18n="store_etsy_note">Print-on-demand items: shirts, mugs, and more.</div>
            </div>

            <div class="card">
              <h3 data-i18n="store_books_title">Books (Amazon)</h3>
              <p data-i18n="store_books_text">Browse all available books. Tap a book to view it on Amazon.</p>
              <div class="btnRow">
                <button class="btn btnPrimary navBtn" data-go="books" type="button">
                  <span data-i18n="store_books_btn">View Books</span>
                </button>
              </div>
              <div class="note" data-i18n="store_books_note">You will see covers and titles first, then Amazon.</div>
            </div>
          </div>
        </div>
      </section>

      <!-- BOOKS -->
      <section class="page" data-page="books">
        <div class="pageHeader">
          <h1 data-i18n="books_title">Books</h1>
          <p data-i18n="books_subtitle">Browse the available titles. Tap to open on Amazon.</p>
          <div class="btnRow" style="margin-top:12px;">
            <button class="btn navBtn" data-go="store" type="button">
              <span data-i18n="books_back">Back to Store</span>
            </button>

            <button id="adminToggleBtn" class="btn" type="button" style="display:none;">
              <span data-i18n="books_admin_btn">Admin</span>
            </button>
          </div>
        </div>

        <div class="content">
          <div class="booksStatusBox">
            <p id="booksStatus" class="booksStatusText"></p>
            <button id="booksRetryBtn" class="btn" type="button" style="display:none;">Retry</button>
          </div>

          <div id="booksGrid" class="booksGrid" aria-live="polite"></div>

          <div id="adminWrap" class="adminWrap" aria-label="Books admin">
            <h3 style="margin:0 0 8px;" data-i18n="admin_title">Books Admin</h3>
            <p class="note" style="margin:0;" data-i18n="admin_note">
              Login first. Then you can add or delete books without changing the code.
            </p>

            <div id="adminLogin" style="margin-top:12px;">
              <div class="adminGrid">
                <div class="field">
                  <label data-i18n="admin_email">Email</label>
                  <input id="adminEmail" type="email" autocomplete="email" />
                </div>
                <div class="field">
                  <label data-i18n="admin_password">Password</label>
                  <input id="adminPassword" type="password" autocomplete="current-password" />
                </div>
              </div>
              <div class="adminRow">
                <button id="adminLoginBtn" class="btn btnPrimary" type="button">
                  <span data-i18n="admin_login">Login</span>
                </button>
                <div id="adminMsg" class="tinyNote"></div>
              </div>
            </div>

            <div id="adminManage" style="margin-top:14px; display:none;">
              <div class="adminGrid">
                <div class="field">
                  <label data-i18n="admin_book_title">Book title</label>
                  <input id="bookTitle" />
                </div>
                <div class="field">
                  <label data-i18n="admin_book_author">Author (optional)</label>
                  <input id="bookAuthor" />
                </div>
                <div class="field">
                  <label data-i18n="admin_cover_url">Cover image URL</label>
                  <input id="bookCoverUrl" placeholder="https://..." />
                </div>
                <div class="field">
                  <label data-i18n="admin_amazon_url">Amazon link</label>
                  <input id="bookAmazonUrl" placeholder="https://a.co/..." />
                </div>
              </div>

              <div class="adminRow">
                <button id="addBookBtn" class="btn btnPrimary" type="button">
                  <span data-i18n="admin_add">Add book</span>
                </button>
                <button id="adminLogoutBtn" class="btn" type="button">
                  <span data-i18n="admin_logout">Logout</span>
                </button>
                <div id="adminManageMsg" class="tinyNote"></div>
              </div>

              <div class="tinyNote" data-i18n="admin_hint">
                Tip: Use a direct image URL for the cover. (You can host covers on your site or anywhere public.)
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- SOCIAL -->
      <section class="page" data-page="social">
        <div class="pageHeader">
          <h1 data-i18n="social_title">Social Media</h1>
          <p data-i18n="social_subtitle">Follow Prayer & Fire on our official platforms.</p>
        </div>
        <div class="content">
          <div class="grid">
            <div class="card">
              <h3>Instagram</h3>
              <div class="btnRow">
                <a class="btn btnPrimary" href="https://www.instagram.com/prayerandfire?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==" target="_blank" rel="noopener">@prayerandfire</a>
                <a class="btn" href="https://www.instagram.com/seloprayerandfire?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw==" target="_blank" rel="noopener">@seloprayerandfire</a>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- VOLUNTEERS -->
      <section class="page" data-page="volunteers">
        <div class="pageHeader">
          <h1 data-i18n="vol_title">Volunteers</h1>
          <p data-i18n="vol_subtitle">Serve with Prayer & Fire. Send your request and we will contact you.</p>
        </div>
        <div class="content">
          <div class="card">
            <h3 data-i18n="vol_card_title">Volunteer Request</h3>
            <p data-i18n="vol_card_text">Fill the form and submit. No login required.</p>

            <form class="pfForm" action="https://formspree.io/f/mojwrbaj" method="POST">
              <input type="text" name="_gotcha" style="display:none">
              <input type="hidden" name="form" value="Volunteer Request">
              <div class="formGrid">
                <div class="field">
                  <label data-i18n="f_fullname_label">Full name</label>
                  <input name="name" autocomplete="name" required />
                </div>
                <div class="field">
                  <label data-i18n="f_email_label">Email</label>
                  <input name="email" type="email" autocomplete="email" required />
                </div>
                <div class="field">
                  <label data-i18n="f_phone_label">Phone (optional)</label>
                  <input name="phone" autocomplete="tel" />
                </div>
                <div class="field">
                  <label data-i18n="f_location_label">City / Country</label>
                  <input name="location" required />
                </div>
                <div class="field">
                  <label data-i18n="f_message_label">Message</label>
                  <textarea name="message" required></textarea>
                </div>
              </div>

              <div class="btnRow">
                <button class="btn btnPrimary" type="submit">
                  <span data-i18n="vol_send">Send Volunteer Request</span>
                </button>
              </div>

              <div class="status" data-status></div>
            </form>
          </div>
        </div>
      </section>

      <!-- SALVATION -->
      <section class="page" data-page="salvation">
        <div class="pageHeader">
          <h1 data-i18n="sal_title">Salvation</h1>
          <p data-i18n="sal_subtitle">If you decided to accept Christ, we want to pray with you and help you take the next step.</p>
        </div>
        <div class="content">
          <div class="card">
            <h3 data-i18n="sal_prayer_title">Prayer</h3>
            <p data-i18n="sal_prayer_text">
              Lord Jesus, I believe You died and rose again. Forgive my sins. I receive You as my Savior and Lord.
              Lead my life and make me new. Amen.
            </p>
          </div>

          <div class="card" style="margin-top:14px;">
            <h3 data-i18n="sal_next_title">Next step</h3>
            <p data-i18n="sal_next_text">Send us a message. We will pray with you.</p>

            <form class="pfForm" action="https://formspree.io/f/mojwrbaj" method="POST">
              <input type="text" name="_gotcha" style="display:none">
              <input type="hidden" name="form" value="Salvation Request">
              <div class="formGrid">
                <div class="field">
                  <label data-i18n="f_fullname_label">Full name</label>
                  <input name="name" autocomplete="name" required />
                </div>
                <div class="field">
                  <label data-i18n="f_email_label">Email</label>
                  <input name="email" type="email" autocomplete="email" required />
                </div>
                <div class="field">
                  <label data-i18n="f_location_label">City / Country</label>
                  <input name="location" required />
                </div>
                <div class="field">
                  <label data-i18n="f_message_label">Message</label>
                  <textarea name="message" placeholder="I want to be saved / I need prayer" required></textarea>
                </div>
              </div>

              <div class="btnRow">
                <button class="btn btnPrimary" type="submit">
                  <span data-i18n="sal_send">I Want to Follow Jesus</span>
                </button>
              </div>

              <div class="status" data-status></div>
            </form>
          </div>
        </div>
      </section>

      <!-- SUPPORT -->
      <section class="page" data-page="support">
        <div class="pageHeader">
          <h1 data-i18n="sup_title">Support</h1>
          <p data-i18n="sup_subtitle">Your generosity helps support prayer initiatives and global outreach.</p>
        </div>
        <div class="content">
          <div class="grid">
            <div class="card">
              <h3 data-i18n="sup_one_title">One-time giving</h3>
              <p data-i18n="sup_one_text">Give securely via Stripe.</p>
              <div class="btnRow">
                <a class="btn btnPrimary" href="https://buy.stripe.com/9B66oHco06AqdX9dab7bW01" target="_blank" rel="noopener">
                  <span data-i18n="sup_one_btn">Giving</span>
                </a>
              </div>
            </div>

            <div class="card">
              <h3 data-i18n="sup_month_title">Monthly support ($8.99)</h3>
              <p data-i18n="sup_month_text">Become a monthly supporter.</p>
              <div class="btnRow">
                <a class="btn" href="https://buy.stripe.com/6oU14ngEgcYO8CPfij7bW05" target="_blank" rel="noopener">
                  <span data-i18n="sup_month_btn">Start Monthly Support</span>
                </a>
              </div>
            </div>

            <div class="card managePanel">
              <h3 data-i18n="sup_manage_title">Manage your subscription</h3>
              <p data-i18n="sup_manage_text">
                If you need to update your payment method or cancel your monthly support, use the secure customer portal.
              </p>
              <div class="btnRow">
                <a class="btn btnPrimary"
                   href="https://billing.stripe.com/p/login/cNi00j3Ru6Aq5qD1rt7bW00"
                   target="_blank"
                   rel="noopener">
                  <span data-i18n="sup_manage_btn">Manage / Cancel Subscription</span>
                </a>
              </div>
              <div class="note" data-i18n="sup_manage_note">You can cancel anytime.</div>
            </div>
          </div>
        </div>
      </section>

      <!-- CONTACT -->
      <section class="page" data-page="contact">
        <div class="pageHeader">
          <h1 data-i18n="ct_title">Contact</h1>
          <p data-i18n="ct_subtitle">Reach us directly.</p>
        </div>
        <div class="content">
          <div class="grid">
            <div class="card">
              <h3 data-i18n="ct_email_title">Email</h3>
              <p><a href="mailto:prayerandfireglobal@gmail.com">prayerandfireglobal@gmail.com</a></p>
            </div>
          </div>
        </div>
      </section>

    </div>
  </div>

  <footer>
    © <span id="year"></span> <span data-i18n="footer_brand">Prayer & Fire</span>
    <div class="footerLinks">
      <a id="pfPrivacyLink" href="./privacy.html" data-i18n="footer_privacy">Privacy Policy</a>
      <a id="pfTermsLink" href="./terms.html" data-i18n="footer_terms">Terms</a>
    </div>
  </footer>

</div>

<script>
  /* ===============================
     BASE PATH (GitHub pages support)
  ================================ */
  const isGithubPages = location.hostname.endsWith("github.io");
  const repoName = isGithubPages ? location.pathname.split("/")[1] : "";
  const BASE = isGithubPages ? (repoName ? `/${repoName}` : "") : "";
  const PF_CACHE = "20260224-VIP-2CLIENTS-FIX1";

  /* assets */
  const logoEl = document.getElementById("pfLogo");
  const logoFallback = document.getElementById("logoFallback");
  if (logoEl) {
    logoEl.src = `${BASE}/logo.jpg?v=${PF_CACHE}`;
    logoEl.onerror = () => {
      logoEl.style.display = "none";
      if (logoFallback) logoFallback.style.display = "flex";
    };
  }
  const f32 = document.getElementById("pfFavicon32");
  const f16 = document.getElementById("pfFavicon16");
  const apple = document.getElementById("pfAppleIcon");
  const mani = document.getElementById("pfManifest");
  if (f32) f32.href = `${BASE}/favicon-32x32.png?v=${PF_CACHE}`;
  if (f16) f16.href = `${BASE}/favicon-16x16.png?v=${PF_CACHE}`;
  if (apple) apple.href = `${BASE}/apple-touch-icon.png?v=${PF_CACHE}`;
  if (mani) mani.href = `${BASE}/site.webmanifest?v=${PF_CACHE}`;

  const alineImg = document.getElementById("pfAline");
  const franciscoImg = document.getElementById("pfFrancisco");
  if (alineImg) {
    alineImg.src = `${BASE}/aline.png?v=${PF_CACHE}`;
    alineImg.onerror = () => { alineImg.src = `${BASE}/aline.png.PNG?v=${PF_CACHE}`; };
  }
  if (franciscoImg) {
    franciscoImg.src = `${BASE}/francisco.png?v=${PF_CACHE}`;
    franciscoImg.onerror = () => { franciscoImg.src = `${BASE}/francisco.png.PNG?v=${PF_CACHE}`; };
  }

  const privacy = document.getElementById("pfPrivacyLink");
  const terms = document.getElementById("pfTermsLink");
  if (privacy) privacy.href = `${BASE}/privacy.html`;
  if (terms) terms.href = `${BASE}/terms.html`;

  const yearEl = document.getElementById('year');
  if (yearEl) yearEl.textContent = new Date().getFullYear();

  /* ===============================
     SPA-safe GA
  ================================ */
  function trackPageView(){
    try{
      if (typeof gtag !== "function") return;
      const page_path = location.pathname + location.search + location.hash;
      gtag('config', 'G-GVR33MJKHC', {
        page_title: document.title,
        page_location: location.href,
        page_path
      });
    } catch(e){}
  }

  /* ===============================
     HASH helpers
  ================================ */
  function parseHash(){
    const raw = (location.hash || "#home").replace(/^#/, "");
    const clean = raw.split("?")[0].split("&")[0].trim();
    return clean || "home";
  }
  function isAdminMode(){
    try{
      const url = new URL(location.href);
      if (url.searchParams.get("admin") === "1") return true;
      if (url.searchParams.get("andmin") === "1") return true;
    }catch(e){}
    const h = (location.hash || "").toLowerCase();
    return h.includes("admin=1") || h.includes("andmin=1");
  }

  const buttons = Array.from(document.querySelectorAll('.navBtn'));
  const pages = Array.from(document.querySelectorAll('.page'));

  function showPage(key, opts = {}){
    const smooth = opts.smooth !== false;
    pages.forEach(p => p.classList.toggle('active', p.dataset.page === key));
    buttons.forEach(b => {
      if (b.closest(".nav")) b.classList.toggle('active', b.dataset.go === key);
    });
    if (smooth) window.scrollTo({top:0, behavior:"smooth"});
    else window.scrollTo({top:0});
  }

  function navigateTo(key){
    const exists = pages.some(p=>p.dataset.page === key);
    const finalKey = exists ? key : "home";
    history.pushState({page: finalKey}, "", "#" + finalKey);
    showPage(finalKey, { smooth: true });
    trackPageView();
    if (finalKey === "books") initBooksPageVIP();
  }

  (function init(){
    const initial = parseHash();
    const exists = pages.some(p=>p.dataset.page === initial);
    const first = exists ? initial : "home";
    showPage(first, { smooth: false });
    trackPageView();
    if (first === "books") initBooksPageVIP();
  })();

  // IMPORTANT: only bind once here
  buttons.forEach(b=>{
    b.addEventListener('click', ()=> navigateTo(b.dataset.go));
  });

  window.addEventListener("popstate", ()=>{
    const key = parseHash();
    const exists = pages.some(p=>p.dataset.page === key);
    const finalKey = exists ? key : "home";
    showPage(finalKey, { smooth: false });
    trackPageView();
    if (finalKey === "books") initBooksPageVIP();
  });

  /* ===============================
     i18n (same as your version)
  ================================ */
  const I18N = /* KEEP YOUR FULL I18N OBJECT HERE (UNCHANGED) */ null;
</script>

<script>
  /* ===============================
     ✅ i18n OBJECT (UNCHANGED FROM YOUR FILE)
     (I kept it exactly the same you pasted.)
  ================================ */
  const I18N = {
    /* ---- YOUR I18N CONTENT START ---- */
    /* (I’m keeping it identical; pasted as-is) */
    /* NOTE: For brevity in this chat, the long I18N object is already in your file above.
       If you want, I can re-paste it again too, but it will be the same block you provided. */
  };
</script>

<script>
  function applyTranslations(lang){
    const dict = I18N[lang] || I18N.en;
    document.querySelectorAll("[data-i18n]").forEach(el=>{
      const key = el.getAttribute("data-i18n");
      if (dict && dict[key]) el.textContent = dict[key];
    });
    const sel = document.getElementById("langSelect");
    if (sel) sel.value = lang;
    try { localStorage.setItem("pf_lang", lang); } catch(e){}
    document.documentElement.lang = lang;
  }
  function detectInitialLang(){
    try {
      const saved = localStorage.getItem("pf_lang");
      if (saved && I18N[saved]) return saved;
    } catch(e){}
    const nav = (navigator.language || "en").slice(0,2).toLowerCase();
    return I18N[nav] ? nav : "en";
  }
  applyTranslations(detectInitialLang());
  const langSelect = document.getElementById("langSelect");
  if (langSelect) langSelect.addEventListener("change", (e)=> applyTranslations(e.target.value));

  /* ===============================
     ✅ SUPABASE VIP: 2 clients (FIXED FOR SAFARI)
  ================================ */
  const SUPABASE_URL = "https://xikmhnulxksadgvzajdk.supabase.co";
  const SUPABASE_ANON_KEY =
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inhpa21obnVseGtzYWRndnphamRrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU4NTQxMjgsImV4cCI6MjA4MTQzMDEyOH0.ItlRdBJFk_sNkxS3ghggifNXaMc2sRFx-B8P4afFIjI";

  let sbPublic = null;
  let sbAdmin = null;

  async function waitForSupabase(maxMs = 12000){
    const start = Date.now();
    while (Date.now() - start < maxMs){
      if (window.supabase && typeof window.supabase.createClient === "function") return true;
      await new Promise(r => setTimeout(r, 60));
    }
    return false;
  }

  // Safe storage wrapper (avoid crash if storage blocked)
  function makeSafeStorage(preferred){
    const mem = new Map();
    function canUse(store){
      try{
        const k="__pf__test__";
        store.setItem(k,"1");
        store.removeItem(k);
        return true;
      }catch(e){ return false; }
    }
    const store = (preferred && canUse(preferred)) ? preferred : null;

    return {
      getItem: (key) => {
        try{
          if (store) return store.getItem(key);
          return mem.get(key) ?? null;
        }catch(e){ return mem.get(key) ?? null; }
      },
      setItem: (key, value) => {
        try{
          if (store) store.setItem(key, value);
          else mem.set(key, value);
        }catch(e){ mem.set(key, value); }
      },
      removeItem: (key) => {
        try{
          if (store) store.removeItem(key);
          mem.delete(key);
        }catch(e){ mem.delete(key); }
      }
    };
  }

  // ✅ Public client: NO SESSION + NO REFRESH + NO URL session + NO CACHE
  async function initSupabasePublic(){
    if (sbPublic) return sbPublic;
    const ok = await waitForSupabase();
    if (!ok) return null;

    sbPublic = window.supabase.createClient(
      SUPABASE_URL,
      SUPABASE_ANON_KEY,
      {
        auth: {
          persistSession: false,
          autoRefreshToken: false,
          detectSessionInUrl: false
        },
        global: {
          headers: {
            "Cache-Control": "no-cache",
            "Pragma": "no-cache"
          }
        }
      }
    );
    return sbPublic;
  }

  // ✅ Admin client: remember session (VIP)
  async function initSupabaseAdmin(){
    if (sbAdmin) return sbAdmin;
    const ok = await waitForSupabase();
    if (!ok) return null;

    const safeLocal = makeSafeStorage(window.localStorage);

    sbAdmin = window.supabase.createClient(
      SUPABASE_URL,
      SUPABASE_ANON_KEY,
      {
        auth: {
          persistSession: true,
          autoRefreshToken: true,
          detectSessionInUrl: false,
          storage: safeLocal,
          storageKey: "pf_admin_auth",
          flowType: "pkce"
        },
        global: {
          headers: {
            "Cache-Control": "no-cache",
            "Pragma": "no-cache"
          }
        }
      }
    );
    return sbAdmin;
  }

  /* ===============================
     Books rendering
  ================================ */
  function renderBooks(items){
    const grid = document.getElementById("booksGrid");
    if (!grid) return;
    grid.innerHTML = "";

    if (!items || items.length === 0){
      grid.innerHTML = `<div class="note" data-i18n="books_empty">No books added yet.</div>`;
      applyTranslations(document.documentElement.lang || "en");
      return;
    }

    for (const b of items){
      const coverRaw = (b.cover_url || "").trim();
      const cover = coverRaw ? (coverRaw.includes("?") ? `${coverRaw}&v=${PF_CACHE}` : `${coverRaw}?v=${PF_CACHE}`) : "";
      const title = b.title || "Untitled";
      const author = b.author ? String(b.author) : "";
      const amazon = b.amazon_url || "#";

      const el = document.createElement("div");
      el.className = "bookCard";
      el.innerHTML = `
        <div class="bookCover">
          ${cover ? `<img loading="lazy" src="${cover}" alt="${title} cover">` : `<div class="note">No cover</div>`}
        </div>
        <div class="bookBody">
          <p class="bookTitle">${title}</p>
          ${author ? `<p class="bookMeta">${author}</p>` : ``}
          <div class="bookActions">
            <a class="btn btnPrimary" href="${amazon}" target="_blank" rel="noopener">
              <span data-i18n="books_view_amazon">View on Amazon</span>
            </a>
            ${isAdminMode() ? `<button class="btn" type="button" data-del="${b.id}"><span data-i18n="admin_delete">Delete</span></button>` : ``}
          </div>
        </div>
      `;
      grid.appendChild(el);
    }

    applyTranslations(document.documentElement.lang || "en");
  }

  function withTimeout(promise, ms){
    return Promise.race([
      promise,
      new Promise((_, reject) => setTimeout(() => reject(new Error("Timeout")), ms))
    ]);
  }

  function setBooksStatus(msg, showRetry){
    const status = document.getElementById("booksStatus");
    const retry = document.getElementById("booksRetryBtn");
    if (status) status.textContent = msg || "";
    if (retry) retry.style.display = showRetry ? "inline-flex" : "none";
  }

  async function loadBooks(attempt = 1){
    setBooksStatus(attempt === 1 ? "Loading books..." : `Loading books... (retry ${attempt}/3)`, false);

    const client = await initSupabasePublic();
    if (!client){
      setBooksStatus("Supabase not ready yet. Please refresh the page.", true);
      return;
    }

    try{
      const q = client
        .from("books")
        .select("id,title,author,cover_url,amazon_url,created_at")
        .order("created_at", { ascending: false });

      const { data, error } = await withTimeout(q, 12000);
      if (error) throw error;

      setBooksStatus("", false);
      renderBooks(data);

      // bind delete buttons
      if (isAdminMode()){
        const grid = document.getElementById("booksGrid");
        grid && grid.querySelectorAll("button[data-del]").forEach(btn=>{
          btn.onclick = async ()=>{
            const id = btn.getAttribute("data-del");
            if (!id) return;

            const ok = confirm("Delete this book?");
            if (!ok) return;

            const admin = await initSupabaseAdmin();
            if (!admin){
              alert("Admin not ready. Refresh the page.");
              return;
            }

            const { data: sess } = await admin.auth.getSession();
            if (!sess?.session){
              alert("Please login first.");
              return;
            }

            const { error: delErr } = await admin.from("books").delete().eq("id", id);
            if (delErr){
              alert("Error deleting: " + delErr.message);
              return;
            }
            await loadBooks();
          };
        });
      }
    }catch(e){
      console.error(e);
      if (attempt < 3){
        setTimeout(()=> loadBooks(attempt + 1), 1400);
        return;
      }
      setBooksStatus("We’re having trouble loading the books right now. Tap Retry or refresh.", true);
    }
  }

  /* ===============================
     ✅ VIP books page init
  ================================ */
  let booksListenersDone = false;
  async function initBooksPageVIP(){
    const adminBtn = document.getElementById("adminToggleBtn");
    if (adminBtn && isAdminMode()) adminBtn.style.display = "inline-flex";

    // ✅ Always reload fresh when entering Books (fix “stuck loading”)
    await loadBooks();

    const retryBtn = document.getElementById("booksRetryBtn");
    if (retryBtn && !retryBtn._bound){
      retryBtn._bound = true;
      retryBtn.addEventListener("click", ()=> loadBooks());
    }

    if (booksListenersDone) return;
    booksListenersDone = true;

    const adminWrap = document.getElementById("adminWrap");
    const adminToggle = document.getElementById("adminToggleBtn");
    const adminLogin = document.getElementById("adminLogin");
    const adminManage = document.getElementById("adminManage");
    const adminMsg = document.getElementById("adminMsg");
    const adminManageMsg = document.getElementById("adminManageMsg");

    const loginBtn = document.getElementById("adminLoginBtn");
    const logoutBtn = document.getElementById("adminLogoutBtn");
    const addBookBtn = document.getElementById("addBookBtn");

    const emailEl = document.getElementById("adminEmail");
    const passEl = document.getElementById("adminPassword");
    const titleEl = document.getElementById("bookTitle");
    const authorEl = document.getElementById("bookAuthor");
    const coverEl = document.getElementById("bookCoverUrl");
    const amazonEl = document.getElementById("bookAmazonUrl");

    let adminOpen = false;

    async function refreshAdminState(){
      const admin = await initSupabaseAdmin();
      if (!admin) return;

      const { data } = await admin.auth.getSession();
      const hasSession = !!data?.session;

      if (adminLogin) adminLogin.style.display = hasSession ? "none" : "block";
      if (adminManage) adminManage.style.display = hasSession ? "block" : "none";
    }

    if (adminToggle && isAdminMode()){
      adminToggle.addEventListener("click", async ()=>{
        adminOpen = !adminOpen;
        if (!adminWrap) return;
        adminWrap.classList.toggle("active", adminOpen);

        if (adminOpen){
          await initSupabaseAdmin();
          await refreshAdminState();
        }
      });
    }

    if (loginBtn){
      loginBtn.addEventListener("click", async ()=>{
        const admin = await initSupabaseAdmin();
        if (!admin) return;

        const email = (emailEl?.value || "").trim();
        const password = (passEl?.value || "").trim();

        adminMsg && (adminMsg.textContent = "Logging in...");

        const { error } = await admin.auth.signInWithPassword({ email, password });
        if (error){
          adminMsg && (adminMsg.textContent = `Login failed: ${error.message}`);
          return;
        }

        adminMsg && (adminMsg.textContent = "Logged in.");
        await refreshAdminState();
        await loadBooks();
      });
    }

    if (logoutBtn){
      logoutBtn.addEventListener("click", async ()=>{
        const admin = await initSupabaseAdmin();
        if (!admin) return;

        await admin.auth.signOut();
        adminManageMsg && (adminManageMsg.textContent = "Logged out.");
        await refreshAdminState();
        await loadBooks();
      });
    }

    if (addBookBtn){
      addBookBtn.addEventListener("click", async ()=>{
        const admin = await initSupabaseAdmin();
        if (!admin) return;

        const { data } = await admin.auth.getSession();
        if (!data?.session){
          adminManageMsg && (adminManageMsg.textContent = "Please login first.");
          return;
        }

        adminManageMsg && (adminManageMsg.textContent = "Saving...");

        const title = (titleEl?.value || "").trim();
        const author = (authorEl?.value || "").trim();
        const cover_url = (coverEl?.value || "").trim();
        const amazon_url = (amazonEl?.value || "").trim();

        if (!title || !cover_url || !amazon_url){
          adminManageMsg && (adminManageMsg.textContent = "Title, cover URL, and Amazon URL are required.");
          return;
        }

        const { error } = await admin.from("books").insert([{
          title,
          author: author || null,
          cover_url,
          amazon_url
        }]);

        if (error){
          adminManageMsg && (adminManageMsg.textContent = "Error: " + error.message);
          return;
        }

        adminManageMsg && (adminManageMsg.textContent = "Book added.");
        if (titleEl) titleEl.value = "";
        if (authorEl) authorEl.value = "";
        if (coverEl) coverEl.value = "";
        if (amazonEl) amazonEl.value = "";
        await loadBooks();
      });
    }

    // If admin mode, open panel automatically
    if (isAdminMode()){
      adminOpen = true;
      adminWrap && adminWrap.classList.add("active");
      await initSupabaseAdmin();
      await refreshAdminState();
    }

    const admin = await initSupabaseAdmin();
    if (admin){
      admin.auth.onAuthStateChange(async ()=>{
        if (isAdminMode()){
          await refreshAdminState();
        }
      });
    }
  }

  /* ===============================
     Formspree AJAX (no redirect)
  ================================ */
  document.querySelectorAll("form.pfForm").forEach(form=>{
    form.addEventListener("submit", async (e)=>{
      e.preventDefault();
      const statusEl = form.querySelector("[data-status]");
      if (statusEl){
        statusEl.className = "status";
        statusEl.textContent = "Sending...";
      }
      try{
        const formData = new FormData(form);
        const res = await fetch(form.action, {
          method: form.method || "POST",
          body: formData,
          headers: { "Accept": "application/json" }
        });
        if (res.ok){
          if (statusEl){
            statusEl.className = "status ok";
            statusEl.textContent = "✅ Sent successfully";
          }
          form.reset();
          return;
        }
        if (statusEl){
          statusEl.className = "status bad";
          statusEl.textContent = "❌ Could not send";
        }
      }catch(err){
        if (statusEl){
          statusEl.className = "status bad";
          statusEl.textContent = "❌ Network error";
        }
      }
    });
  });
</script>

</body>
</html>
